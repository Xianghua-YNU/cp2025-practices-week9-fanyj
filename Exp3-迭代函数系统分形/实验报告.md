# 迭代函数系统(IFS)分形实验报告

## 实验目的

1. 理解迭代函数系统(IFS)的基本原理和算法
2. 掌握"混沌游戏"随机迭代方法
3. 实现巴恩斯利蕨和概率树的生成
4. 分析不同参数对分形图形的影响

## 实验过程

### 1. 核心算法实现

**IFS参数定义**:
- 巴恩斯利蕨: 4个仿射变换(茎干、小叶片、左右大叶片)
- 其中茎干变换使得图形生成蕨类植物的茎的部分；小叶片变换用于生成蕨类植物上大量较小的叶片部分；左右大叶片变换分别生成蕨类植物左右两侧较大的叶片部分。
- 概率树: 3个仿射变换(树干、左右分支)
- 树干变换确定了树的主干形态，左右分支变换则分别生成树的左右分支结构。

**混沌游戏算法**:
1. 初始化起始点      设置初始点为 (0, 0)，作为迭代的起始位置。
2. 随机选择变换(按概率)
   根据每个变换对应的概率，使用随机数来决定选择哪个仿射变换。通过计算累计概率并与随机数比较来实现这一过程。
4. 应用仿射变换生成新点
   将选择的仿射变换应用到当前点上，通过矩阵乘法和加法运算得到新的点坐标。
6. 重复迭代生成点集
   不断重复上述步骤，生成大量的点，这些点最终构成了分形图形。
### 2. 分形实现

**巴恩斯利蕨参数**:
- 茎干变换: 概率0.01
- 小叶片变换: 概率0.85
- 左右大叶片变换: 各概率0.07

**概率树参数**:
- 树干变换: 概率0.10
- 左右分支变换: 各概率0.45

### 3. 遇到的问题与解决

(请在此描述实现过程中遇到的问题及解决方法)
图形显示不完整
在绘制图形时，由于没有设置合适的坐标轴范围，导致部分点没有显示在图形中，图形看起来不完整。
解决方法：在 plot_ifs 函数中，使用 plt.axis('equal') 确保坐标轴比例相等，并根据生成的点集范围适当调整坐标轴的显示范围，使图形完整显示。
## 结果展示

### 1. 巴恩斯利蕨

[插入生成的巴恩斯利蕨分形图]![8d4fd88229bbed80f62391668fd4016b](https://github.com/user-attachments/assets/3334f583-27f8-46a8-adb9-45e2d1c16b20)

- 展示不同变换对应的叶片部分
- 从生成的图形可以清晰地看到，茎干变换生成了蕨类植物的细长茎；小叶片变换生成了大量密集分布的小叶片，构成了蕨类植物的主要叶片部分；左右大叶片变换分别在蕨类植物的左右两侧生成了较大的叶片，增加了图形的层次感和真实感。
- 分析概率参数对叶片密度的影响
- 小叶片变换的概率为 0.85，是所有变换中概率最大的，因此生成的小叶片数量最多，密度最大。茎干变换概率仅为 0.01，生成的茎的部分相对较少。左右大叶片变换概率均为 0.07，生成的大叶片数量相对较少，分布在两侧。概率越大，对应的部分在图形中出现的频率越高，密度也就越大。

### 2. 概率树 
[插入生成的概率树分形图]![37781382e567cec39f6191ad73da57c2](https://github.com/user-attachments/assets/018a25bd-31b5-44ec-81c2-d505be1c89ba)

- 展示分支结构
- 树干变换生成了树的主干，从起始点向上延伸。左右分支变换分别在主干的两侧生成了分支，形成了树的基本结构。随着迭代的进行，分支不断细分，呈现出复杂的树形结构。
- 分析变换参数对树形的影响
- 树干变换的参数决定了树干的粗细和生长方向。左右分支变换的参数，如旋转角度和缩放比例等，影响了分支的倾斜角度和大小。

## 分析与思考

1. **IFS特性分析**
   - 仿射变换参数对图形各部分的影响
   - 仿射变换参数中的 a、b、c、d 主要影响图形的旋转、缩放和平移。在巴恩斯利蕨中，不同的参数组合使得叶片呈现出不同的形状和方向；在概率树中，参数决定了树干和分支的形态和生长方向。e 和 f 参数则主要影响图形的平移位置，确定了各部分在平面上的具体位置。
   - 概率参数与图形密度的关系
   - 概率参数直接决定了每个变换在迭代过程中被选择的频率。概率越高，对应的变换生成的点越多，在图形中该部分的密度也就越大。

2. **参数实验**
   - 修改概率参数的效果
   - 增加某一变换的概率，会使该变换生成的部分在图形中更加突出，密度增大。
   - 调整变换参数的效果
   - 调整仿射变换参数会改变图形各部分的形状、大小和位置。在概率树中，调整左右分支变换的参数，可以改变分支的倾斜角度、粗细和长度，从而使树形发生显著变化。

3. **扩展思考**
   - 如何设计新的IFS规则生成其他分形
   - 可以通过研究不同分形的几何特征，设计合适的仿射变换参数和概率。例如，对于雪花分形，可以设计多个围绕中心对称的仿射变换，通过调整参数使其呈现出雪花的形状
   - 添加颜色渐变效果的方法
   - 可以根据点的生成顺序、所属变换或者点的坐标等因素来分配颜色。例如，按照点的生成顺序，从一种颜色渐变到另一种颜色；或者根据点所属的变换，为不同变换生成的点分配不同颜色。在绘制时，使用 plt.scatter 的 c 参数传入颜色数组来实现颜色渐变效果。
   - 性能优化方案(减少点数同时保持视觉效果)
   - 可以采用抽样的方法，在生成一定数量的点后，每隔一定数量的点选取一个点进行绘制，这样可以减少绘制的点数，同时保持图形的大致形态。
4. **算法比较**
   - IFS与其他分形生成方法的对比
   - 与 L-System 相比，IFS 通过随机迭代生成点集来构成分形图形，更侧重于概率和仿射变换；而 L-System 通过符号重写规则生成字符串，再根据字符串中的指令绘制图形，更侧重于规则的描述和迭代过程。
   - 随机迭代与确定性迭代的差异
   - 随机迭代（如 IFS 中的混沌游戏算法）引入了随机性，每次运行生成的图形可能会有细微的差异，使得图形具有一定的不确定性和自然感。确定性迭代（如 L-System 中的字符串重写迭代）按照固定的规则进行，每次运行生成的图形完全相同，具有明确的规律性和可重复性。

**注：请在每一部分补充你自己的实验内容、图像、分析和关键代码。**
